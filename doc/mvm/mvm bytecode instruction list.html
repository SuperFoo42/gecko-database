<html>

<header>
<link rel="stylesheet" href="css/themes/blue/style.css" type="text/css" media="print, projection, screen" />
<script type="text/javascript" src="js/jquery-3.2.1.min.js"></script> 
<script type="text/javascript" src="js/jquery.tablesorter.js"></script> 
<script>
$(document).ready(function() 
    { 
        $("#tab_instructions").tablesorter(); 
        $("#tab_datatypes").tablesorter(); 
        $("#tab_columnflags").tablesorter(); 
        $("#tab_tabletypes").tablesorter(); 
    } 
); 
</script>
</header>

<body>



<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;border-color:#ccc;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#ccc;color:#333;background-color:#fff;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#ccc;color:#333;background-color:#f0f0f0;}
.tg .tg-9hbo{font-weight:bold;vertical-align:top}
.tg .tg-yw4l{vertical-align:top}
</style>

<h1>MVM Bytecode Instruction List</h1>

<table id="tab_instructions" class="tablesorter">
<thead>
  <tr>
    <th class="header headerSortDown">Mnemonic</th>
    <th class="header">Opcode (Hex, 1 byte)</th>
    <th class="header">Operand (8 byte)</th>
    <th class="header">Stack (&#91;top,...&#93; &rarr; &#91;top,...&#93;)</th>
    <th class="header">Description</th>
  </tr>
</thead>  
<tbody>
   <tr>
    <td>tcreate</td>
    <td>01</td>
    <td>force</td>
    <td>pointer to string &rarr; table handle</td>
    <td>Creates a new table with the name as given by the string pointer. Leads to an <code>ABORT</code> if a table exists with the given name and <i>force</i> is not set to <i>1</i>. Finishes the program with exit code 2 (<code>ABORT BY SYSTEM</code>), and a rollback is initialized. In case, <i>force</i> is set to <i>1</i> the table is dropped if it exists, and a new table with the given name is added. If successfully, an <i>table handle</i> to access the new table is pushed onto the stack. <b>Note:</b> the instruction <code>tinstall</code> must be placed somewhere below this instruction to complete the operation.</td>
  </tr>
    <tr>
        <td>tinstall</td>
        <td>02</td>
        <td></td>
        <td>&#91;table type, table handle&#93; &rarr; </td>
        <td>Installs the table given by <i>table handle</i> as a type of <a href="#tabletypes">table type</a>. Removes the <i>table type argument</i> from the stack.</td>
    </tr>
    <tr>
        <td>tdrop</td>
        <td>03</td>
        <td></td>
        <td>table handle &rarr; </td>
        <td>Drops the table given by <i>table handle</i>, and removes the <i>table handle</i> from the stack. In case no table with the given handle is found, an <code>ABORT</code> is invoked and a rollback is initialized. The program exits with exit code 2 (<code>ABORT BY SYSTEM</code>) in this case.</td>
    </tr>
    <tr>
        <td>dclone</td>
        <td>04</td>
        <td></td>
        <td>pointer to string &rarr; </td>
        <td>Clones the current database into a path indicated by a string referenced by <i>pointer to string</i>. In case an I/O error occurs, an <code>ABORT</code> is invoked and a rollback is initialized. The program exits with exit code 2 (<code>ABORT BY SYSTEM</code>) in this case.</td>
    </tr>
    <tr>
        <td>dopen</td>
        <td>05</td>
        <td>force</td>
        <td>&#91;timeout, pointer to string&#93; &rarr; </td>
        <td>Opens the database stored in a path indicated by a string referenced by <i>pointer to string</i>. In case an I/O error occurs, an <code>ABORT</code> is invoked and a rollback is initialized, i.e., the current database remains open. The program exits with exit code 2 (<code>ABORT BY SYSTEM</code>) in this case. <b>Note</b>: Once this instruction is invoked, newly added transaction are automatically aborted until the opening process finishes. The parameter <i>force</i> defines the handling of running transactions. If <i>force</i> is set to <i>1</i>, all running transactions are aborted immediately. If <i>force</i> is set to <i>0</i>, this instructions waits until other running transactions are completed. If the waiting duration exceeds <i>timeout</i> milliseconds, other running transactions are aborted anyway and the opening process is issued. </td>
    </tr>
    <tr>
        <td>tdup</td>
        <td>06</td>
        <td></td>
        <td>&#91;table handle (original), pointer to string&#93; &rarr; table handle (copy)</td>
        <td>Constructs a copy of the table <i>table handle (original)</i> with the name referenced by <i>pointer to string</i>, and pushes the table handle onto the stack. In case no table with the the id <i>table handle (original)</i> is found or there is another table with the name referenced by <i>pointer to string</i>, an <code>ABORT</code> is invoked and a rollback is initialized. The program exits with exit code 2 (<code>ABORT BY SYSTEM</code>) in this case.</td>
    </tr>
    <tr>
        <td>byname</td>
        <td>07</td>
        <td></td>
        <td>pointer to string &rarr; table handle</td>
        <td>Finds the table handle associated with the name as given by <i>pointer to string</i>, and pushes <i>table handle</i> onto the stack. In case no table with the given name is found, an <code>ABORT</code> is invoked and a rollback is initialized. The program exits with exit code 2 (<code>ABORT BY SYSTEM</code>) in this case.</td>
    </tr>
    <tr>
        <td>tlist</td>
        <td>08</td>
        <td></td>
        <td>&rarr; &#91;num, table handle 0, table handle 1, ..., table handle (num-1)&#93;</td>
        <td>Pushes all tables handles onto the stack. The element on top is a number indicating the number of installed tables.</td>
    </tr>
     <tr>
        <td>tinsert</td>
        <td>09</td>
        <td></td>
        <td>&#91;num, table handle&#93; &rarr; field handle</td>
        <td>Inserts <i>num</i> (uninitialized) tuplets into the table identified by <i>table handle</i>. Both input arguments are removed from the stack, an <i>field handle</i> is pushed onto the stack. The <i>field handle</i> points to the first field of the first inserted tuplet. In case <i>num</i> is less than or equal to zero, or the <i>table handle</i> is unknown, an <code>ABORT</code> is invoked and a rollback is initialized. The program exits with exit code 2 (<code>ABORT BY SYSTEM</code>) in this case.</td>
    </tr>
    <tr>
        <td>fwrite</td>
        <td>0A</td>
        <td></td>
        <td>&#91; data, field handle &#93; &rarr; field handle</td>
        <td>Writes <i>data</i> into the field associated with <i>field handle</i>, moves <i>field handle</i> to the next field and removes <i>data</i> from the stack. Which data type is used for <i>data</i> is inferred by the associated column of the table. In case the field handle is moves beyond the last field of the current tuplet, it is set to the first field in the subsequent tuplet. In case the field handle is moved outside the bounds of the tbale, an <code>ABORT</code> is invoked and a rollback is initialized. The program exits with exit code 2 (<code>ABORT BY SYSTEM</code>) in this case.</td>
    </tr>
    <tr>
        <td>txnlist</td>
        <td>0B</td>
        <td></td>
        <td>&rarr; &#91;num, transaction handle 0, transaction handle 1, ..., transaction handle (num-1)&#93;</td>
        <td>Pushes all transaction handles onto the stack. The element on top is a number indicating the number of existing transactions.</td>
    </tr>
    <tr>
        <td>txninfo</td>
        <td>0C</td>
        <td></td>
        <td>transaction handle &rarr; </td>
        <td>Prints information to stdout about the transaction associated with the handle <i>transaction handle</i>.</td>
    </tr>
    <tr>
        <td>txnclean</td>
        <td>0D</td>
        <td></td>
        <td>&rarr; </td>
        <td>Removes finished transactions from the transaction register.</td>
    </tr>
    <tr>
        <td>sleep</td>
        <td>0E</td>
        <td>time</td>
        <td>&rarr; </td>
        <td>Suspends the thread for this transaction for <i>time</i> milliseconds.</td>
    </tr>
    <tr>
        <td>tinfo</td>
        <td>0F</td>
        <td></td>
        <td>table handle &rarr; </td>
        <td>Displays information to stdout about the table associated with the handle <i>table handle</i>.</td>
    </tr>
    <tr>
        <td>foreach <i>inst</i></td>
        <td>10</td>
        <td></td>
        <td>&#91;num, ... &#93; &rarr; <i>inst</i>(&#91;...&#93;) 0, <i>inst</i>(&#91;...&#93;) 1, ..., <i>inst</i>(&#91;...&#93;) (num - 1)</td>
        <td>Runs the next instruction <i>inst</i> (program counter + 1) <i>num</i> times. Removes <i>num</i> from the stack before the first call to <i>inst</i> is done.</td>
    </tr>
  <tr>
    <td>addcol</td>
    <td>11</td>
    <td></td>
    <td>&#91;table handle, pointer to string, type, rep, flags &#93; &rarr; &#91;column handle, table handle&#93;</td>
    <td>Adds a new column with the name references by <i>pointer to string</i> to the table associated with <i>table handle</i>. The <a href="#datatypes">data type</a> is defined by <i>type</i>. For fixed-length field types (e.g., <code>VARCHAR(n)</code>) set <i>rep</i> to <i>n</i>. The value <i>flags</i> is an xor-ed number defining the <a href="#columnflags">column flags</a>. In case <i>table handle</i> is unknown, this action leads to an <code>ABORT</code> and the program finishes with exit code 2 (<code>ABORT BY SYSTEM</code>). If successfully, an <i>column handle</i> to access the new column and the original <i>table handle</i> are pushed onto the stack</td>
  </tr>
   <tr>
    <td>vstore</td>
    <td>12</td>
    <td>i</td>
    <td></td>
    <td>Stores the top value of the stack into an u64 variable with index i. The stack is not modified.</td>
  </tr>
  <tr>
    <td>vload</td>
    <td>13</td>
    <td>i</td>
    <td>&rarr; value</td>
    <td>Loads the value of the variable with index <i>i</i> and pushes the value onto the stack.</td>
  </tr>
  <tr>
    <td>isset</td>
    <td>14</td>
    <td>i</td>
    <td>&rarr; bool</td>
    <td>Checks whether the variable with index <i>i</i> was set before by <code>vstore</code> or similar. Pushes <i>1</i> onto the stack if so otherwise <i>0</i>.</td>
  </tr>
   <tr>
    <td>pop</td>
    <td>15</td>
    <td></td>
    <td>value &rarr;</td>
    <td>Removes the top value from the stack</td>
  </tr>
  <tr>
    <td>npop</td>
    <td>16</td>
    <td></td>
    <td>&#91;num, value 0, value 1,..., value (num-1)&#93; &rarr; </td>
    <td>Removes <i>num</i> values from the stack</td>
  </tr>
  <tr>
    <td>ipush</td>
    <td>17</td>
    <td>value</td>
    <td>&rarr; value</td>
    <td>Pushes value onto the stack as an u64 value</td>
  </tr>
  <tr>
    <td>swap</td>
    <td>18</td>
    <td></td>
    <td>&#91;value1, value2&#93; &rarr; &#91;value2, value1&#93;</td>
    <td>Swaps the two top elements of the stack</td>
  </tr>
  <tr>
    <td>commit</td>
    <td>FC</td>
    <td></td>
    <td></td>
    <td>Finishes the program with exit code 0 (<code>COMMIT</code>). Changes to the system are permanent.</td>
  </tr>
  <tr>
    <td>abort</td>
    <td>FA</td>
    <td></td>
    <td></td>
    <td>Finishes the program with exit code 1 (<code>ABORT BY USER</code>). A rollback is initialized, and changes to the system are discarded.</td>
  </tr>
</tbody>  
</table>

<h1 id="datatypes">Datatypes</h1>

<table id="tab_datatypes" class="tablesorter">
<thead>
  <tr>
    <th class="header headerSortDown">Type Name</th>
    <th class="header">Storage</th>
    <th class="header">Type ID</th>
    <th class="header">Description</th>
  </tr>
</thead>  
<tbody>
    <tr>
        <td><code>BOOL</code></td>
        <td>1 byte</td>
        <td>0</td>
        <td>Allows boolean values 1 (true) and 0 (false)</td>
    </tr>
    <tr>
        <td><code>INT8</code></td>
        <td>1 byte</td>
        <td>1</td>
        <td>Allows whole numbers between -127 and 127</td>
    </tr>
    <tr>
        <td><code>INT16</code></td>
        <td>2 byte</td>
        <td>3</td>
        <td>Allows whole numbers between -32767 and 32767</td>
    </tr>
    <tr>
        <td><code>INT32</code></td>
        <td>4 byte</td>
        <td>4</td>
        <td>Allows whole numbers between -2147483647 and 2147483647</td>
    </tr>
    <tr>
        <td><code>INT64</code></td>
        <td>8 byte</td>
        <td>5</td>
        <td>Allows whole numbers between -9223372036854775807 and 9223372036854775807</td>
    </tr>
    <tr>
        <td><code>UINT8</code></td>
        <td>1 byte</td>
        <td>2</td>
        <td>Allows whole numbers between 0 and 255</td>
    </tr>
    <tr>
        <td><code>UINT16</code></td>
        <td>2 byte</td>
        <td>6</td>
        <td>Allows whole numbers between 0 and 65535</td>
    </tr>
    <tr>
        <td><code>UINT32</code></td>
        <td>4 byte</td>
        <td>7</td>
        <td>Allows whole numbers between 0 and 4294967295</td>
    </tr>
    <tr>
        <td><code>UINT64</code></td>
        <td>8 byte</td>
        <td>8</td>
        <td>Allows whole numbers between 0 and 18446744073709551615</td>
    </tr>
    <tr>
        <td><code>FLOAT32</code></td>
        <td>4 byte</td>
        <td>9</td>
        <td>Single precision approximate numerical with 23 bits of significand, 8 bits of exponent, and 1 sign bit.</td>
    </tr>
    <tr>
        <td><code>FLOAT64</code></td>
        <td>8 byte</td>
        <td>10</td>
        <td>Double precision approximate numerical with 52 bits of significand, 11 bits of exponent, and 1 sign bit.</td>
    </tr>
    <tr>
        <td><code>CHAR</code></td>
        <td>1 byte</td>
        <td>11</td>
        <td>Character string of length 1. In case <code>VARCHAR(n)</code> is required, see <i>rep</i> during column creation. </td>
    </tr>

</tbody>  
</table>


<h1 id="columnflags">Column Flags</h1>

<table id="tab_columnflags" class="tablesorter">
<thead>
  <tr>
    <th class="header headerSortDown">Flag Name</th>
    <th class="header">Value</th>
    <th class="header">Restrictions</th>
    <th class="header">Description</th>
  </tr>
</thead>  
<tbody>


    <tr>
        <td><code>PRIMARY</code></td>
        <td>1</td>
        <td>No combination with <code>FOREIGN</code> or <code>NULLABLE</code></td>
        <td>Defines a column as primary key column. Multiple columns can have this flag. The flag <code>UNIQUE</code> is automatically turned on, if this flag is set.</td>
    </tr>
    <tr>
        <td><code>FOREIGN</code></td>
        <td>2</td>
        <td>No combination with <code>PRIMARY</code> or <code>NULLABLE</code></td>
        <td>Defines a column as foreign key column. Multiple columns can have this flag.</td>
    </tr>
    <tr>
        <td><code>NULLABLE</code></td>
        <td>4</td>
        <td>No combination with <code>PRIMARY</code>, <code>FOREIGN</code> or <code>AUTOINC</code></td>
        <td>Turns on <i>null</i> values for a column. Multiple columns can have this flag.</td>
    </tr>
    <tr>
        <td><code>AUTOINC</code></td>
        <td>8</td>
        <td>No combination with <code>NULLABLE</code> or <code>FOREIGN</code></td>
        <td>Newly added fields in this column are automatically incremented.</td>
    </tr>
    <tr>
        <td><code>UNIQUE</code></td>
        <td>16</td>
        <td></td>
        <td>Newly added fields must contain values that are unique in this column. <i>Null</i> values are treated as one single (unique) value. Hence, having this flag applied, only one <i>null</i> value is allowed.</td>
    </tr>
    

</tbody>  
</table>

<h1 id="tabletypes">Table Types</h1>

<table id="tab_tabletypes" class="tablesorter">
<thead>
  <tr>
    <th class="header headerSortDown">Name</th>
    <th class="header">Linearization</th>
    <th class="header">Fragment Type</th>
    <th class="header">Device</th>
    <th class="header">Allocator</th>
    <th class="header">Type Id</th>    
    <th class="header">Description</th>
  </tr>
</thead>  
<tbody>


    <tr>
        <td><code>HOST PLAIN COLUMN STORE</code></td>
        <td>DSM</td>
        <td>Fat</td>
        <td>Host</td>
        <td><code>malloc</code></td>
        <td>1</td>
        <td>A relational table in which records are stored column-wise in one continuous memory block. Null values are encoded using one value from the columns <a href="#datatypes">data type</a> domain.</td>
    </tr>

    <tr>
        <td><code>HOST PLAIN ROW STORE</code></td>
        <td>NSM</td>
        <td>Fat</td>
        <td>Host</td>
        <td><code>malloc</code></td>
        <td>2</td>
        <td>A relational table in which records are stored row-wise in one continuous memory block. Null values are encoded using one value from the columns <a href="#datatypes">data type</a> domain.</td>
    </tr>
    
    

</tbody>  
</table>

</body>
</html>